<!DOCTYPE html>
<html>
    <head>
        <title>CS 416: Narrative Visualization - Nithin Nathan</title>
        <meta charset="UTF-8">
        <meta name="description" content="CS 416: Narrative Visualization - Nithin Nathan">
        <meta name="author" content="Nithin Nathan">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="mystyle.css">
        <script src="https://d3js.org/d3.v4.min.js"></script>
    </head>
    <body>
        <h1 align="center">U.S. Gun Violence (1980s-2020s)</h1>
        <p align="left">The United States is the home of the highest rate of gun ownership worldwide due to safeguarding by the Second Amendment to the U.S. Constitution.<br>
            Individuals with firearms find usage through various activities, such as self-defense, hunting, and target shooting.<br>
            Although there are several harmless use cases for firearms, there are many harmful ones as well, and in this narrative visualization you will be able to explore some other statistics that demonstrate the violence caused by individuals who own a firearm in America.<br>
        </p>
        <p align="left">Source:<a href='https://www.kaggle.com/datasets/nidzsharma/us-mass-shootings-19822023' class="link" target="_blank" rel="noreferrer noopener"> https://www.kaggle.com/datasets/nidzsharma/us-mass-shootings-19822023</a></p>
        <div align="left">
            <p>The buttons below will help you explore and understand these metrics.</p>
            <a href="index.html" class="other">Home</a>
            <a href="about.html" class="other">About</a>
            <a href="#" class="current">Fatalities</a>
            <a href="injured.html" class="other">Injured</a>
            <a href="total_victims.html" class="other">Total Victims</a>
            <a href="conclusion.html" class="other">Conclusion</a>
        </div>

        <h3>Fatalities Over Time</h3>
        <p>This line chart shows the sum of fatalities over time.</p>
            
        <div id="#chart-container"></div>
        <script>

            //var parseDate = d3.timeParse("%m/%d/%Y");

            var margin = {left: 50, right: 20, top: 20, bottom: 50 };

            var width = 960 - margin.left - margin.right;
            var height = 500 - margin.top - margin.bottom;

            var max = 0;

            var xNudge = 50;
            var yNudge = 20;

            //var minDate = new Date();
            //var maxDate = new Date();

            d3.csv("https://raw.githubusercontent.com/nithinnathan/nithinnathan.github.io/master/fatalities.csv")
                .row(function(d) { return { year: d.Year, fatalities: d.Fatalities } })
                .get(function(error, rows) {
                    
                    maxFatalities = d3.max(rows, function(d) { return d.Fatalities; });
                    minYear = d3.min(rows, function(d) {return d.Year; });
                    maxYear = d3.max(rows, function(d) { return d.Year; });

                    var y = d3.scaleLinear()
                                .domain([0,maxFatalities])
                                .range([height,0]);

                    var x = d3.scaleTime()
                                .domain([minYear,maxYear])
                                .range([0,width]);

                    var yAxis = d3.axisLeft(y);

                    var xAxis = d3.axisBottom(x);

                    var line = d3.line()
                        .x(function(d){ return x(d.Year); })
                        .y(function(d){ return y(d.Fatalities); })
                        .curve(d3.curveCardinal);

                    var svg = d3.select("#chart-container").append("svg").attr("id","svg").attr("height","100%").attr("width","100%");
                    var chartGroup = svg.append("g").attr("class","chartGroup").attr("transform","translate("+xNudge+","+yNudge+")");

                    chartGroup.append("path")
                        .attr("class","line")
                        .attr("d",function(d){ return line(rows); })

                    chartGroup.append("g")
                        .attr("class","axis x")
                        .attr("transform","translate(0,"+height+")")
                        .call(xAxis);

                    chartGroup.append("g")
                        .attr("class","axis y")
                        .call(yAxis);
                });
            
            // const margin = { top: 10, right: 30, bottom: 30, left: 60 },
            //     width = 660 - margin.left - margin.right,
            //     height = 400 - margin.top - margin.bottom;

            // const svg = d3.select("#chart-container")
            //                 .append("svg")
            //                     .attr("width", width + margin.left + margin.right)
            //                     .attr("height", height + margin.top + margin.bottom)
            //                 .append("g")
            //                     .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            // d3.csv("https://raw.githubusercontent.com/nithinnathan/nithinnathan.github.io/master/fatalities.csv")
            //     .row(function(d) { return { year: d.Year, fatalities: d.Fatalities } })
            //     .get(function(error, data) {
                
            //         var sumstat = d3.nest().entries(data);
            //         console.log(sumstat);

            //         const x = d3.scaleLinear()
            //                     .domain([0,d3.extent(data, d => d.Year)])
            //                     .range([0,width]);

            //         svg.append("g").attr("transform", "translate(0," + height + ")")
            //             .call(d3.axisBottom(x).ticks(10).tickFormat(d3.format("d")));
                            
            //         const y = d3.scaleLinear()
            //                     .domain([50, d3.max(data, function(d) { return d.Fatalities; })])
            //                     .range([height,0]);

            //         svg.append("g").call(d3.axisLeft(y).ticks(10));

            //         const line = d3.line()
            //                         .x(d => x(d.Year))
            //                         .y(d => y(d.Fatalities));

            //         // svg.selectAll(".line")
            //         //     .data(sumstat)
            //         //     .enter()
            //         //     .append("path")
            //         //     .attr("fill", "none")
            //         //     .attr("stroke", "steelblue")
            //         //     .attr("stroke-width", 2.5)
            //         //     .attr("d", function(d) {
            //         //         return d3.line()
            //         //             .x(function(d) { return x(d.Year); })
            //         //             .y(function(d) { return y(+d.Fatalities); })
            //         //             (d.values)});
            // });
        </script>
    </body>
</html>