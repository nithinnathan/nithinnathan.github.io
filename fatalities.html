<!DOCTYPE html>
<html>
    <head>
        <title>CS 416: Narrative Visualization - Nithin Nathan</title>
        <meta charset="UTF-8">
        <meta name="description" content="CS 416: Narrative Visualization - Nithin Nathan">
        <meta name="author" content="Nithin Nathan">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="mystyle.css">
        <script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/d3-annotation/2.3.1/d3-annotation.min.js"></script>
    </head>
    <body>
        <h1 align="center">U.S. Gun Violence From the 1980s to the 2020s</h1>
        <p align="left">Gun ownership in the United States is the highest in the world, and constitutionally protected by the Second Amendment to the United States Constitution. Firearms are widely used in the United States for self-defence, hunting, and recreational uses, such as target shooting.</p>
        <!-- <p align="left">Source:<a href='https://www.kaggle.com/datasets/nidzsharma/us-mass-shootings-19822023' target="_blank" rel="noreferrer noopener">https://www.kaggle.com/datasets/nidzsharma/us-mass-shootings-19822023</a></p> -->
        <div align="left">
            <p>The buttons below will help you explore and understand some metrics of the number of individuals affected by gun violence in the United States across 5 decades.</p>
            <a href="index.html" class="other">Home</a>
            <a href="#" class="current">Fatalities</a>
            <a href="injured.html" class="other">Injured</a>
            <a href="total_victims.html" class="other">Total Victims</a>
            <a href="conclusion.html" class="other">Conclusion</a>
        </div>

        <h3>Fatalities Over Time</h3>
        <p>This line chart shows the sum of fatalities over time.</p>
            
        <div id="fatalities"></div>
        <div id="tooltip" opacity=0></div>

        <script>
        
            var margin = { left: 60, right: 30, top: 10, bottom: 30 };
            var width = 500 - margin.left - margin.right;
            var height = 500 - margin.top - margin.bottom;
            
            d3.csv("https://github.com/nithinnathan/nithinnathan.github.io/blob/master/fatalities.csv", function(data)
            {
            
                // group the data: I want to draw one line per group
                // var sumstat = d3.nest() // nest function allows to group the calculation per level of a factor
                // .key(function(d) { return d.Location;})
                // .entries(data);
                //document.getElementById("data").innerHTML = sumstat;
                //console.log(sumstat);

                
            
                var x = d3.scaleLinear()
                .domain([1982,2023])
                .range([0,500]);

                var y = d3.scaleLinear()
                .domain([0,120])
                .range([500,0]);

                var xAxis = d3.axisBottom(x);

                var yAxis = d3.axisLeft(y);

                var line = d3.line()
                            .x(function(d) { return x(d.Year) })
                            .y(function(d) { return y(d.Fatalities) });

                // append the svg object to the body of the page
                var svg = d3.select("#fatalities")
                .append("svg")
                .attr("id", "svg")
                .attr("width", "100%")
                .attr("height", "100%");

                var chartGroup = svg.append("g").attr("class")
                
                    
                // color palette
                //var res = sumstat.map(function(d){ return d.key }) // list of group names
                //console.log(res);
                // var color = d3.scaleOrdinal()
                // .domain(data)
                // .range(['#e41a1c','#377eb8','#4daf4a','#984ea3','#ff7f00','#ffff33','#a65628','#f781bf','#999999'])
            
                var tooltip = d3.select("body").append("div").attr("class", "toolTip");
                //var tooltip1 = d3.select('svg').select('#tooltip').attr("class", "toolTip");
                //console.log(tooltip);
                //console.log(tooltip1);
            
                // Draw the line
                svg.selectAll("line")
                    .data(data)
                    .enter()
                    .append("path")
                    .attr("fill", "none")// .attr("stroke", function(d){ return color(d.key) }//.attr("stroke-dasharray", function(d,i){ return i })
                    .attr("stroke-width", 2.5)
                    .attr("d", function(d) {
                        return d3.line()
                        .x(function(d) { return x(d.Year); })
                        .y(function(d) { return y(+d.Fatalities); })
                        (d.values)
                    });
                    // .on("mouseover", function (d,i) {
                    // tooltip
                    //     .style("left", d3.event.pageX - 50 + "px")
                    //     .style("top", d3.event.pageY - 70 + "px")
                    //     .style("display", "inline-block")
                    //     .style("font-family", "Georgia")
                    //     .style("font-size", "70%")
                    //     .html(d.key + ": Year " + d.values[i]['Year'] + ": " + d.values[i]['Life_Exp']);
                    //     //console.log(d.values);
                    //     //console.log(d.values[i]);
                    // })
                    // .on("mouseout", function (d) { tooltip.style("display", "none"); })
                    // ;
                    
                // //Legend
                // const colDict = {India: '#e41a1c', World: '#377eb8' , Germany: '#4daf4a', United_Kingdom: '#984ea3', United_States: '#ff7f00'}
                // var legend_keys = ["India", "World", "Germany", "United_Kingdom", "United_States"]
            
                // var lineLegend = svg.selectAll(".lineLegend").data(legend_keys)
                //     .enter().append("g")
                //     .attr("class","lineLegend")
                //     .attr("transform", function (d,i) {
                //             return "translate(" + width + "," + (i*20)+")";
                //         });
            
                // lineLegend.append("text").text(function (d) {return d;})
                //     .attr("transform", "translate(-200,250)"); //align texts with boxes
            
                // lineLegend.append("rect")
                //     //.attr("fill", function (d) {return color(d.key); })
                //     .attr("fill", d => colDict[d])
                //     .attr("transform", "translate(-220,240)")
                //     .attr("width", 10).attr("height", 10);
            })
        
        </script>
    </body>
</html>