<!DOCTYPE html>
<html>
    <head>
        <title>CS 416: Narrative Visualization - Nithin Nathan</title>
        <meta charset="UTF-8">
        <meta name="description" content="CS 416: Narrative Visualization - Nithin Nathan">
        <meta name="author" content="Nithin Nathan">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="mystyle.css">
        <script src="https://d3js.org/d3.v4.min.js"></script>
    </head>
    <body>
        
        <h1 align="center">U.S. Gun Violence (1980s-2020s)</h1>
        
        <div align="center">
            <p>The buttons below will help you explore and understand these metrics.</p>
            <a href="index.html" class="other">About</a>
            <a href="#" class="current">Fatalities</a>
            <a href="injured.html" class="other">Injured</a>
            <a href="total_victims.html" class="other">Total Victims</a>
        </div>

        <h3>Fatalities Over Time</h3>
        <p>
            A fatality is defined as <i>"an occurrence of death by accident, in war, or from disease"</i>.<br>
            In the case of gun violence, fatalities refer to individuals who passed away due to gun-related events.<br>
            This line chart shows the sum of fatalities over time.<br>
        </p>
            
        <div id="fatalities"></div>
        <div id="tooltip"></div>
        <script>

            var margin = {top: 0, right: 30, bottom: 30, left: 30},
                width = 660 - margin.left - margin.right,
                height = 660 - margin.top - margin.bottom;

            var svg = d3.select("#fatalities")
            .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
            .append("g")
                .attr("transform",
                    "translate(" + margin.left + "," + margin.top + ")");

            d3.csv("https://raw.githubusercontent.com/nithinnathan/nithinnathan.github.io/master/fatalities.csv", function(data) {

                var sumstat = d3.nest()
                    .key(function(d) { return d.Location; })
                    .entries(data);

                var x = d3.scaleLinear()
                    .domain(d3.extent(data, function(d) { return d.Year; }))
                    .range([0,width]);

                svg.append("g")
                    .attr("transform", "translate(0," + height + ")")
                    .call(d3.axisBottom(x).ticks(10).tickFormat(d3.format("d")));

                var y = d3.scaleLinear()
                    .domain([0,d3.max(data, function(d) { return +d.Fatalities; })])
                    .range([height,0]);
                    
                svg.append("g")
                    .call(d3.axisLeft(y).ticks(10));

                var tooltip = d3.select("body").append("div").attr("class", "toolTip");

                svg.selectAll(".line")
                    .data(sumstat)
                    .enter()
                    .append("path")
                        .attr("fill", "none")
                        .attr("stroke", "darkblue")
                        .attr("stroke-dasharray", function(d,i) { return i; })
                        .attr("stroke-width", 2)
                        .attr("d", function(d){
                        return d3.line()
                            .x(function(d) { return x(d.Year); })
                            .y(function(d) { return y(+d.Fatalities); })
                            (d.values)
                        })
                    .on("mouseover", function (d,i) {
                        tooltip.style("left", d3.event.pageX - 50 + "px")
                        .style("top", d3.event.pageY - 70 + "px")
                        .style("display", "inline-block")
                        .style("font-family", "Helvetica")
                        .style("font-size", "70%")
                        .html("Sum of Fatalities: 1100");
                        })
                    .on("mouseout", function (d) { tooltip.style("display", "none"); });
            })
        </script>
    </body>
</html>